{% extends 'composter_Base.html' %}
{% load static %}





{% block content %}

<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@200;400&display=swap" rel="stylesheet">


<style>

a {
    font-family:'Nunito';
    text-decoration: none;
    font-size: 1.2em;
    padding:10px 0;
    transition: color 0.4s ease;
    border-radius: 4px;
    border: 0.2px solid yellow;
    color: #DEFF99;

}

a:hover {
    background-color: #DEFF99;
    transition: color 0.4s ease;
    color: #857B63;
}

#left-page {
    background-color: #857B63;
    height: 910px;
}

#left-page div:nth-child(1){
    width: 90%;
    padding: 5px;
    margin-top: 120px;
    margin-bottom: 80px;
}

#left-page div:nth-child(2), #left-page div:nth-child(3),#left-page div:nth-child(4),#left-page div:nth-child(5),#left-page div:nth-child(6){
    width: 90%;
    padding:5px 0;
    margin:10px 0;
}

#left-page div:nth-child(6) a {
    color: rgb(255, 150, 100);
    border: 0.2px solid rgb(255, 150, 100);
}


#left-page .icon
{
    font-size: 1.3em;
}

.menu a {
    display: flex;
    align-items: center;
    padding-left: 35px;
  }
  
  .menu a i {
    margin-right: 5px;
    vertical-align: middle;
  }


#right-page {
    background-color: #FDF7EA;
}

#map {
    height: 400px;
    width: 70%;
    margin-bottom: 150px;
}

</style>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

<div class="fluid-container">



    <div class="row">
        <div class="col-6 col-lg-2 col-sm-4 col-md-4 d-flex flex-column align-items-center text-center menu" id="left-page">

            <div class="logo"><img src="{% static 'images/composter_logo.svg' %}"></div>
            <div class="c-greeners-calndar"><a href="{% url 'composterHome' %}"><i class='bx bxs-dashboard icon'></i>Dashboard</a></div>
            <div class="c-greeners-request"><a href="{% url 'getGreenersOffer'%}"><i class='bx bx-cart-download icon'></i>Greeners Request</a></div>
            <div class="c-greeners-request"><a href="{% url 'getPendingMembres' %}"><i class='bx bxs-user-detail'></i>Pending membres</a></div>
            <div class="mb-5 c-greeners-request"><a href="{% url 'getComposterMembers' %}"><i class='bx bxs-user-detail'></i>My membres</a></div>
            <div class="mt-5"><a href="{% url 'logoff' %}"><i class='bx bx-log-out icon' ></i>Logout</a></div>
        
        </div>
    

        <div class="col-6 col-lg-10 col-sm-8 col-md-8 d-flex flex-column align-items-center " id="right-page">
            <div>{{ request.user.CommunityName }} Community</div>
            <div id="map"></div>
            
            <div class="d-flex flex-column align-items-center justify-content-center">
                <p>Compost Request : </p>
                <p>Dechet Vert : </p>
                <p>Dechet Sec : </p>
                <p>Dechet fumier : </p>
                <p>Total : </p>
            </div>
        </div>

    </div>




</div>

<script>

    var map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);


    fetch('/Composter/offers_data/')
    .then(response => response.json())
    .then(data => {
        console.log(data.GreenersOffersJson);
        
        // Loop through the JSON data and create a marker for each location
        data.GreenersOffersJson.forEach(offer => {
            const marker = L.marker([offer.GreenerLocationY, offer.GreenerLocationX]).addTo(map);
            marker.bindPopup(`Name: ${offer.GreenerFirstName} ${offer.GreenerLastName}<br>Animal Manure Quantity: ${offer.AnimalManureQuantity}<br>Plant Fertilizers Quantity: ${offer.PlantFertilizersQuantity}<br>Biodegradable Fertilizers Quantity: ${offer.BiodegradableFertilizersQuantity}<br>Start Date: ${offer.StartDate}<br>End Date: ${offer.EndDate}`);
        });
    })
    .catch(error => console.error(error));


</script>
{% endblock %}